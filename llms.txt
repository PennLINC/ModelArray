# ModelArray

`ModelArray` is an R package for statistical analysis of fixel-wise data
and beyond. Its features include:

- Easy to use: set up your statistical analysis with just several lines
  of code;
- Supporting linear and nonlinear modeling, and extensible to more
  models:
  - At present, `ModelArray` supports linear models as well as
    generalized additive models (GAMs) with and without penalized
    splines, which are particularly useful for studying nonlinear
    effects in lifespan data. `ModelArray` is also extensible to diverse
    models available in R;
- Scalable for large-scale datasets;
- Compatible with fixel-wise data, voxel-wise data, and
  greyordinate-wise data.

Please cite our [NeuroImage
paper](https://doi.org/10.1016/j.neuroimage.2023.120037) if you use
`ModelArray`:

> Zhao, C., Tapera, T. M., Bagautdinova, J., Bourque, J., Covitz, S.,
> Gur, R. E., Gur, R. C., Larsen, B., Mehta, K., Meisler, S. L., Murtha,
> K., Muschelli, J., Roalf, D. R., Sydnor, V. J., Valcarcel, A. M.,
> Shinohara, R. T., Cieslak, M. & Satterthwaite, T. D. (2023).
> ModelArray: an R package for statistical analysis of fixel-wise data.
> *NeuroImage*, *271*, 120037.
> <https://doi.org/10.1016/j.neuroimage.2023.120037>

## Overview

![Overview](reference/figures/overview_structure.png)

Overview

ModelArray is packaged with the companion software
[ConFixel](https://github.com/PennLINC/ConFixel) for converting
fixel-wise data, voxel-wise data or greyordinate-wise data to the
expected file format that ModelArray uses. Specifically,
[ConFixel](https://github.com/PennLINC/ConFixel) is Python-based
command-line interface software, and it converts between the original
image format (`.mif` for fixel-wise data, NIfTI for voxel-wise data,
CIFTI-2 for greyordinate-wise data) and the HDF5 file format (`.h5`)
used for ModelArray.

## Installation

Please refer to webpage
[Installation](https://pennlinc.github.io/ModelArray/articles/installations.html)
for a full guidance of installation of `ModelArray` and its companion
python package [ConFixel](https://github.com/PennLINC/ConFixel). The
most important steps for installing `ModelArray` are:

- Make sure you have necessary libraries for HDF5 - see [this
  section](https://pennlinc.github.io/ModelArray/articles/installations.html#install-hdf5-libraries-in-the-system)
- Install `ModelArray` from GitHub - see [this
  section](https://pennlinc.github.io/ModelArray/articles/installations.html#install-modelarray-r-package-from-github)

Additionally, we also provide a [container
image](https://hub.docker.com/r/pennlinc/modelarray_confixel) that
includes `ModelArray` and `ConFixel`. With this container image, there
is no need for the user to install `ModelArray`, `ConFixel`, and
dependent R and Python packages. Please see [this
webpage](https://pennlinc.github.io/ModelArray/articles/container.html)
for how to use this container image.

## How to use

Load the `ModelArray` package into R via:

``` r
library(ModelArray)
```

We provide a walkthrough
[here](https://pennlinc.github.io/ModelArray/articles/walkthrough.html)
with example fixel-wise data. For additional notes on application to
voxel-wise data, please refer to
[here](https://pennlinc.github.io/ModelArray/articles/voxel-wise_data.html).

For documentation of `ModelArray` functions, you can:

- Either go to [this
  webpage](https://pennlinc.github.io/ModelArray/reference/index.html);
- Or in R console, type: `help(<function_name>)`. For example:
  [`help(ModelArray.lm)`](https://pennlinc.github.io/ModelArray/reference/ModelArray.lm.md)

Full documentation of `ModelArray` can be found
[here](https://pennlinc.github.io/ModelArray/).

Source code of `ModelArray` can be found
[here](https://github.com/PennLINC/ModelArray).

# Package index

## All functions

- [`ModelArray()`](https://pennlinc.github.io/ModelArray/reference/ModelArray.md)
  : An S4 class to represent element-wise scalar data and statistics.
- [`ModelArray.gam()`](https://pennlinc.github.io/ModelArray/reference/ModelArray.gam.md)
  : Run GAM for element-wise data
- [`ModelArray.lm()`](https://pennlinc.github.io/ModelArray/reference/ModelArray.lm.md)
  : Fit linear model for element-wise data
- [`ModelArray.wrap()`](https://pennlinc.github.io/ModelArray/reference/ModelArray.wrap.md)
  : Run a user-supplied function for element-wise data
- [`analyseOneElement.gam()`](https://pennlinc.github.io/ModelArray/reference/analyseOneElement.gam.md)
  : Fit GAM for one element
- [`analyseOneElement.lm()`](https://pennlinc.github.io/ModelArray/reference/analyseOneElement.lm.md)
  : Fit linear model for one element.
- [`analyseOneElement.wrap()`](https://pennlinc.github.io/ModelArray/reference/analyseOneElement.wrap.md)
  : Run a user-supplied function for one element
- [`exampleElementData()`](https://pennlinc.github.io/ModelArray/reference/exampleElementData.md)
  : Example per-element data.frame for user functions
- [`gen_gamFormula_contIx()`](https://pennlinc.github.io/ModelArray/reference/gen_gamFormula_contIx.md)
  : Generate GAM formula with continuous\*continuous interaction
- [`gen_gamFormula_fxSmooth()`](https://pennlinc.github.io/ModelArray/reference/gen_gamFormula_fxSmooth.md)
  : Generate GAM formula with factor-smooth interaction
- [`numElementsTotal()`](https://pennlinc.github.io/ModelArray/reference/numElementsTotal.md)
  : Number of elements in ModelArray
- [`show(`*`<ModelArray>`*`)`](https://pennlinc.github.io/ModelArray/reference/show-ModelArray-method.md)
  : Show ModelArray object
- [`writeResults()`](https://pennlinc.github.io/ModelArray/reference/writeResults.md)
  : Write outputs from element-wise statistical analysis to the HDF5
  file.

# Articles

### All vignettes

- [An intro to
  R](https://pennlinc.github.io/ModelArray/articles/basic_r_intro.md):
- [Getting started with
  containers](https://pennlinc.github.io/ModelArray/articles/container.md):
- [Debugging](https://pennlinc.github.io/ModelArray/articles/debugging.md):
- [Developer
  documentation](https://pennlinc.github.io/ModelArray/articles/doc_for_developer.md):
- [FAQ](https://pennlinc.github.io/ModelArray/articles/faq.md):
- [Installation](https://pennlinc.github.io/ModelArray/articles/installations.md):
- [Application to voxel-wise
  data](https://pennlinc.github.io/ModelArray/articles/voxel-wise_data.md):
- [Example
  walkthrough](https://pennlinc.github.io/ModelArray/articles/walkthrough.md):
- [Developing a function for
  ModelArray.wrap](https://pennlinc.github.io/ModelArray/articles/wrap_function.md):
