<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with containers • ModelArray</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with containers">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ModelArray</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basic_r_intro.html">An intro to R</a></li>
    <li><a class="dropdown-item" href="../articles/container.html">Getting started with containers</a></li>
    <li><a class="dropdown-item" href="../articles/debugging.html">Debugging</a></li>
    <li><a class="dropdown-item" href="../articles/doc_for_developer.html">Developer documentation</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/installations.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/voxel-wise_data.html">Application to voxel-wise data</a></li>
    <li><a class="dropdown-item" href="../articles/walkthrough.html">Example walkthrough</a></li>
    <li><a class="dropdown-item" href="../articles/wrap_function.html">Developing a function for ModelArray.wrap</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started with containers</h1>
            
      

      <div class="d-none name"><code>container.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="preface">Preface<a class="anchor" aria-label="anchor" href="#preface"></a>
</h2>
<p>Target audience: Any user who wants to use a container to run
<code>ModelArray</code> and/or <code>ConFixel</code></p>
<p>What is covered on this page? How to use the container image of
<code>ModelArray + ConFixel</code>.</p>
<p>What is not covered on this page? Step by step details on how to run
<code>ModelArray</code> and <code>ConFixel</code>. For a full
walkthrough on how to use our software, please refer to
<code><a href="../articles/walkthrough.html">vignette("walkthrough")</a></code>. We highly suggest reviewing that
page if you’re new to <code>ModelArray</code>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Besides running <code>ModelArray</code> and <code>ConFixel</code> on
a local computer, users also have an option to run them on High
Performance Computing (HPC) clusters. When using HPC clusters, users may
not have full privilege to install all the dependent packages.
Therefore, we provide the option to download our software as a container
image that includes <code>ModelArray + ConFixel</code>.</p>
<p>Our container image is publicly available at <a href="https://hub.docker.com/r/pennlinc/modelarray_confixel" class="external-link">Docker
Hub</a>. Although HPC clusters do not usually support
<code>docker</code> commands, this container image can be run with
<code>singularity</code> commands, which are usually available on HPC
clusters (see below for details).</p>
</div>
<div class="section level2">
<h2 id="using-singularity-to-run-on-hpc-clusters">Using singularity to run on HPC clusters<a class="anchor" aria-label="anchor" href="#using-singularity-to-run-on-hpc-clusters"></a>
</h2>
<p>Prerequisite: Singularity is installed on your cluster. If not,
please contact your cluster’s administrator.</p>
<div class="section level3">
<h3 id="pull-the-container-from-docker-hub">Pull the container from Docker Hub<a class="anchor" aria-label="anchor" href="#pull-the-container-from-docker-hub"></a>
</h3>
<p>We first pull the container from Docker Hub using the
<code>singularity pull</code> command as follows:</p>
<pre class="console"><code>singularity pull docker://pennlinc/modelarray_confixel:&lt;tagName&gt;</code></pre>
<p>You will replace <code>&lt;tagName&gt;</code> with the actual tag,
e.g., <code>0.1.2</code>, or <code>latest</code>. You should see a
singularity image (<code>.sif</code>) in current directory:
<code>modelarray_confixel_&lt;tagName&gt;.sif</code></p>
<p>After pulling, let’s make sure you can <code>singularity run</code>
the image:</p>
<pre class="console"><code>singularity run --cleanenv \
    modelarray_confixel_&lt;tagName&gt;.sif \
    R</code></pre>
<p>You should now be inside an R environment with the capability to load
the <code>ModelArray</code> R package as you would in RStudio:
<code><a href="https://pennlinc.github.io/ModelArray">library(ModelArray)</a></code>.</p>
<p>This is also the way to interactively use this container image to run
R, but please make sure you mount necessary directories with
<code>-B</code> - see below for explanations.</p>
</div>
<div class="section level3">
<h3 id="how-to-run-the-container">How to run the container?<a class="anchor" aria-label="anchor" href="#how-to-run-the-container"></a>
</h3>
<pre class="console"><code>singularity run --cleanenv -B /directory/of/your/data \
  /path/to/singularity/image/modelarray_confixel_&lt;tagName&gt;.sif \
  &lt;command you want to run&gt;</code></pre>
<p>Here:</p>
<p><code>-B /directory/of/your/data</code> allows you to mount the data
directory so that <code>singularity</code> can read and write data
inside it. If your data exists inside your current working directory,
you might do <code>-B $PWD</code>;</p>
<p><code>/path/to/singularity/image/modelarray_confixel_&lt;tagName&gt;.sif</code>
is the full path to the singularity image (<code>.sif</code>) you
pulled;</p>
<p><code>ModelArray</code> and <code>ConFixel</code> are both included
in this container. To run <code>ConFixel</code>, simply replace
<code>&lt;command you want to run&gt;</code> with <code>ConFixel</code>
commands (e.g., <code>confixel</code>).</p>
<p>To run <code>ModelArray</code>, you may first save the R commands
into an R script, then replace
<code>&lt;command you want to run&gt;</code> with
<code>Rscript /path/to/your/Rscript</code>. Make sure this Rscript has
been mounted (<code>-B</code>), too, e.g., If it’s not in the directory
<code>/directory/of/your/data</code>, please do:
<code>-B /directory/of/your/data,/directory/of/Rscript</code>. See <a href="https://singularity-userdoc.readthedocs.io/en/latest/bind_paths_and_mounts.html" class="external-link">here</a>
for more on how to mount multiple directories.</p>
<p>You might submit this command <code>singularity run</code> as a job
running on the cluster compute node.</p>
</div>
</div>
<div class="section level2">
<h2 id="more-information">More information?<a class="anchor" aria-label="anchor" href="#more-information"></a>
</h2>
<p>We have provided a detailed example walkthrough of
<code>ModelArray</code> and <code>ConFixel</code> at:
<code><a href="../articles/walkthrough.html">vignette("walkthrough")</a></code>. Please refer to this page for a
tutorial on how to use <code>ModelArray</code> and
<code>ConFixel</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chenying Zhao, Tinashe Tapera, Matthew Cieslak, Theodore Satterthwaite.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
