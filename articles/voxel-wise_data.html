<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Application to voxel-wise data • ModelArray</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Application to voxel-wise data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ModelArray</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basic_r_intro.html">An intro to R</a></li>
    <li><a class="dropdown-item" href="../articles/container.html">Getting started with containers</a></li>
    <li><a class="dropdown-item" href="../articles/debugging.html">Debugging</a></li>
    <li><a class="dropdown-item" href="../articles/doc_for_developer.html">Developer documentation</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/installations.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/voxel-wise_data.html">Application to voxel-wise data</a></li>
    <li><a class="dropdown-item" href="../articles/walkthrough.html">Example walkthrough</a></li>
    <li><a class="dropdown-item" href="../articles/wrap.html">Writing custom element-wise analyses with ModelArray.wrap</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Application to voxel-wise data</h1>
            
      

      <div class="d-none name"><code>voxel-wise_data.Rmd</code></div>
    </div>

    
    
<p><code>ModelArray</code> is compatible with not only fixel-wise data,
but also voxel-wise data. The <code><a href="../articles/walkthrough.html">vignette("walkthrough")</a></code> page
has shown example walkthrough with example fixel-wise data, with hints
for voxel-wise data provided throughout the walkthrough. In general, the
workflow of applying <code>ModelArray</code> to voxel-wise data is
consistent to that of fixel-wise data, but please note several important
differences when execution described as below.</p>
<div class="section level2">
<h2 id="conversion-of-voxel-wise-data-format">Conversion of voxel-wise data format<a class="anchor" aria-label="anchor" href="#conversion-of-voxel-wise-data-format"></a>
</h2>
<p>When converting voxel-wise data between NIfTI and HDF5 file format
that <code>ModelArray</code> requires, you will still use
<code>ConFixel</code> software, but a different converter tailored for
voxel-wise data, <code>ConVoxel</code>. We have provided a walkthrough
of how to use it <a href="https://github.com/PennLINC/ConFixel/blob/main/notebooks/walkthrough_voxel-wise_data.md" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="applying-modelarray-to-voxel-wise-data">Applying <code>ModelArray</code> to voxel-wise data<a class="anchor" aria-label="anchor" href="#applying-modelarray-to-voxel-wise-data"></a>
</h2>
<p>You can apply the same <code>ModelArray</code> functions, arguments,
etc used in fixel-wise data to voxel-wise data; just be aware that an
“element” is a “voxel” now.</p>
<p>In addition, there are additional arguments specifically useful for
voxel-wise data, regarding the <strong>subject-specific masks</strong>
(i.e., individual masks). Different from fixel-wise data where subjects
usually share the same mask, voxel-wise data may have
<em>subject-specific masks</em>, where different subjects may have
different brain coverage even in template space. Therefore, for voxels
(e.g., at the edge of the brain) which do not have data from sufficient
number of subjects, their statistic results might not be reliable. It’s
better to exclude those voxels from the analysis.</p>
<p>In <code>ConVoxel</code>, for voxels not within a subject-specific
mask (but within a larger, group-level mask), their values will be set
to <code>NaN</code>. Thus <code>ModelArray</code> can know the number of
subjects that have valid values in each voxel within the group mask.</p>
<p>To set up minimal number of subjects required for a voxel, you can
use these two arguments in <code><a href="../reference/ModelArray.lm.html">ModelArray.lm()</a></code> and
<code><a href="../reference/ModelArray.gam.html">ModelArray.gam()</a></code>:</p>
<ul>
<li>
<code>num.subj.lthr.abs</code>: lower threshold, absolute number of
subjects; e.g., 10</li>
<li>
<code>num.subj.lthr.rel</code>: lower threshold, proportion of total
number of subjects, a value between 0-1; e.g., 0.2 (i.e., 20% of all
subjects)</li>
</ul>
<p>Suppose a voxel has valid values from N subjects, where N:</p>
<ul>
<li>N &gt; <code>num.subj.lthr.abs</code>, and</li>
<li>N &gt; <code>num.subj.lthr.rel</code> * <code>Ntotal</code>
</li>
</ul>
<p>where <code>Ntotal</code> is the total number of subjects, which is
quantified by number of rows in argument <code>phenotypes</code>. If N
satisfied above criteria, statistical analysis of this voxel will be
performed as normal; otherwise, this voxel will be skipped and
statistical outputs will be set as <code>NaN</code>.</p>
<!--- `Ntotal` is defined as `num.subj.total <- nrow(phenotypes)` --->
<!--- confirmed it's `>`, not `>=` --->
<p>For more details about these two arguments, please check the
reference pages of <code><a href="../reference/ModelArray.lm.html">ModelArray.lm()</a></code> and
<code><a href="../reference/ModelArray.gam.html">ModelArray.gam()</a></code>.</p>
<p>Finally, if you choose to save number of observations used (i.e., if
specifying <code>nobs</code> in <code>var.model</code> in
<code><a href="../reference/ModelArray.lm.html">ModelArray.lm()</a></code> and <code><a href="../reference/ModelArray.gam.html">ModelArray.gam()</a></code>), after
conversion using <code>ConVoxel</code>, you’ll see an image called
<code>*_model.nobs*</code>. If the subject-specific masks you provided
are different across subjects, in this image you’ll probably see the
heterogeneity of number of observations used in the brain, with fewer
observations used at the edge of the brain.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chenying Zhao, Tinashe Tapera, Matthew Cieslak, Theodore Satterthwaite.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
